<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Life OS - Web Sync</title>
    
    <!-- React & Babel -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- FIREBASE SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, onSnapshot, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // --- ðŸ”¥ BURAYI MOBÄ°LDEKÄ° AYNISIYLA DOLDUR ---
        const firebaseConfig = {
  apiKey: "AIzaSyB_zE9V8BtMtDjCyeT2FW8IqTe7CN4cSL8",
  authDomain: "lifeos-app-82013.firebaseapp.com",
  projectId: "lifeos-app-82013",
  storageBucket: "lifeos-app-82013.firebasestorage.app",
  messagingSenderId: "890704581310",
  appId: "1:890704581310:web:f9aa83314a207eda6904ef",
};

        window.firebaseApp = initializeApp(firebaseConfig);
        window.db = getFirestore(window.firebaseApp);
        window.doc = doc;
        window.onSnapshot = onSnapshot;
        window.setDoc = setDoc;
    </script>

    <style>
        body { font-family: 'Inter', system-ui, sans-serif; -webkit-tap-highlight-color: transparent; background-color: #f3f4f6; }
        /* Scrollbar Gizleme */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        /* Flip Card Efekti */
        .perspective-1000 { perspective: 1000px; }
        .transform-style-3d { transform-style: preserve-3d; }
        .backface-hidden { backface-visibility: hidden; }
        .rotate-y-180 { transform: rotateY(180deg); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const USER_DOC_ID = "my_life_os_data_v6"; // Mobildeki ID ile AYNI olmalÄ±

        // VarsayÄ±lanlar (BoÅŸ gelirse diye)
        const DEFAULT_HABITS = [{ id: 'h1', title: 'YataÄŸÄ± Topla', icon: 'ðŸ›ï¸' }, { id: 'h2', title: 'Kitap Oku', icon: 'ðŸ“–' }];
        const DEFAULT_REWARDS = [{ id: 1, title: "Kahve", cost: 20, icon: "â˜•" }];

        function App() {
            const [data, setData] = useState(null);
            const [activeTab, setActiveTab] = useState('planner');
            const [selectedDate, setSelectedDate] = useState(new Date());
            const [modal, setModal] = useState({ open: false, type: null, data: null });
            const [form, setForm] = useState({});
            const [flippedCards, setFlippedCards] = useState({}); // Proje kartlarÄ± iÃ§in

            // --- FIREBASE BAÄžLANTISI ---
            useEffect(() => {
                const checkDB = setInterval(() => {
                    if (window.db) {
                        clearInterval(checkDB);
                        window.onSnapshot(window.doc(window.db, "lifeos_data", USER_DOC_ID), (doc) => {
                            if (doc.exists()) {
                                setData(doc.data());
                            } else {
                                const initData = { projects: [], history: {}, habits: DEFAULT_HABITS, rewards: DEFAULT_REWARDS, gold: 0 };
                                window.setDoc(window.doc(window.db, "lifeos_data", USER_DOC_ID), initData);
                                setData(initData);
                            }
                        });
                    }
                }, 100);
            }, []);

            // Ä°konlarÄ± gÃ¼ncelle
            useEffect(() => { lucide.createIcons(); }, [data, activeTab, modal]);

            if (!data) return <div className="h-screen flex items-center justify-center text-indigo-600 font-bold animate-pulse">LifeOS Buluta BaÄŸlanÄ±yor...</div>;

            // --- YARDIMCILAR ---
            const getDateKey = (d) => {
                const year = d.getFullYear();
                const month = String(d.getMonth() + 1).padStart(2, '0');
                const day = String(d.getDate()).padStart(2, '0');
                return `${year}-${month}-${day}`;
            };
            const dateKey = getDateKey(selectedDate);
            const todayKey = getDateKey(new Date());
            const currentDayData = data.history[dateKey] || { tasks: [], habits: [], journal: null };

            // --- EYLEMLER (SAVE) ---
            const saveToFirebase = (newData) => {
                setData(newData);
                window.setDoc(window.doc(window.db, "lifeos_data", USER_DOC_ID), newData);
            };

            // 1. AltÄ±n Ä°ÅŸlemleri
            const updateGold = (amount) => saveToFirebase({...data, gold: data.gold + amount});

            // 2. Rutin Ä°ÅŸlemleri
            const toggleHabit = (id) => {
                const isDone = (currentDayData.habits || []).includes(id);
                let newHabits = isDone ? currentDayData.habits.filter(h => h !== id) : [...(currentDayData.habits||[]), id];
                
                let goldChange = 0;
                if (dateKey === todayKey) goldChange = isDone ? -5 : 5;

                const newHistory = { ...data.history, [dateKey]: { ...currentDayData, habits: newHabits } };
                saveToFirebase({ ...data, history: newHistory, gold: data.gold + goldChange });
            };

            // 3. GÃ¶rev Ä°ÅŸlemleri
            const addTask = () => {
                const newTask = modal.type === 'simple' 
                    ? { id: Date.now(), title: form.title, type: 'simple', completed: false, duration: form.time || '30', startTime: form.startTime || '' }
                    : { id: Date.now(), title: `${modal.data.title} (${form.amount} ${modal.data.unit})`, type: 'project_slice', pid: modal.data.id, subItems: new Array(Number(form.amount)).fill(false), completed: false, duration: form.time || '60', startTime: form.startTime || '' };
                
                const newHistory = { ...data.history, [dateKey]: { ...currentDayData, tasks: [...currentDayData.tasks, newTask] } };
                saveToFirebase({ ...data, history: newHistory });
                setModal({open: false});
            };

            const toggleTask = (id) => {
                const task = currentDayData.tasks.find(t => t.id === id);
                const newStatus = !task.completed;
                const updatedTasks = currentDayData.tasks.map(t => t.id === id ? {...t, completed: newStatus} : t);
                
                let goldChange = 0;
                if (dateKey === todayKey) goldChange = newStatus ? 10 : -10;

                const newHistory = { ...data.history, [dateKey]: { ...currentDayData, tasks: updatedTasks } };
                saveToFirebase({ ...data, history: newHistory, gold: data.gold + goldChange });
            };

            const toggleSubItem = (taskId, idx) => {
                let goldChange = 0;
                let projectsUpdate = [...data.projects];

                const updatedTasks = currentDayData.tasks.map(t => {
                    if (t.id === taskId) {
                        const newSub = [...t.subItems];
                        const wasDone = newSub[idx];
                        newSub[idx] = !wasDone;
                        
                        if (t.type === 'project_slice') {
                            projectsUpdate = projectsUpdate.map(p => {
                                if (p.id === t.pid) {
                                    const change = wasDone ? -1 : 1;
                                    return { ...p, currentUnit: Math.max(0, (p.currentUnit||0) + change) };
                                }
                                return p;
                            });
                            if (dateKey === todayKey) goldChange = wasDone ? -5 : 5;
                        }
                        const allDone = newSub.every(Boolean);
                        return { ...t, subItems: newSub, completed: allDone };
                    }
                    return t;
                });

                const newHistory = { ...data.history, [dateKey]: { ...currentDayData, tasks: updatedTasks } };
                saveToFirebase({ ...data, history: newHistory, projects: projectsUpdate, gold: data.gold + goldChange });
            };

            const deleteTask = (id) => {
                const newHistory = { ...data.history, [dateKey]: { ...currentDayData, tasks: currentDayData.tasks.filter(t => t.id !== id) } };
                saveToFirebase({ ...data, history: newHistory });
            };

            // 4. Proje Ä°ÅŸlemleri (Edit/New)
            const saveProject = () => {
                const pData = {
                    id: form.id || Date.now(),
                    title: form.title,
                    totalUnit: Number(form.total),
                    currentUnit: Number(form.current) || 0,
                    unit: form.unit,
                    totalEstTime: Number(form.estTime),
                    notes: form.notes || ''
                };
                let newProjs = form.id ? data.projects.map(p => p.id === form.id ? {...p, ...pData} : p) : [...data.projects, pData];
                saveToFirebase({...data, projects: newProjs});
                setModal({open:false});
            };

            const updateProjectNotes = (pid, text) => {
                const newProjs = data.projects.map(p => p.id === pid ? {...p, notes: text} : p);
                saveToFirebase({...data, projects: newProjs});
            };

            // 5. DiÄŸer Ekleme/Silme
            const addHabit = () => {
                saveToFirebase({...data, habits: [...data.habits, {id: Date.now(), title: form.title, icon: form.icon}]});
                setForm({...form, title:'', icon:''});
            };
            const deleteHabit = (id) => saveToFirebase({...data, habits: data.habits.filter(h => h.id !== id)});
            
            const addReward = () => {
                saveToFirebase({...data, rewards: [...data.rewards, {id: Date.now(), title: form.title, cost: Number(form.cost), icon: form.icon}]});
                setModal({open:false});
            };
            const deleteReward = (id) => saveToFirebase({...data, rewards: data.rewards.filter(r => r.id !== id)});
            const buyReward = (r) => {
                if(data.gold >= r.cost && confirm(`${r.title} al?`)) updateGold(-r.cost);
                else if(data.gold < r.cost) alert("Para yok!");
            };

            // 6. GÃ¼nlÃ¼k
            const saveJournal = () => {
                const newHistory = { ...data.history, [dateKey]: { ...currentDayData, journal: { mood: form.mood, note: form.note } } };
                saveToFirebase({ ...data, history: newHistory });
                setModal({open:false});
            };

            // --- RENDER ---
            return (
                <div className="flex flex-col h-screen max-w-md mx-auto bg-white shadow-2xl overflow-hidden border-x border-gray-200">
                    
                    {/* HEADER */}
                    <div className="p-5 bg-white border-b flex justify-between items-center z-20">
                        <div>
                            <div className="text-[10px] font-bold text-gray-400 uppercase">DURUM</div>
                            <div className="flex items-center gap-2">
                                <span className="text-sm font-bold">Senkronize ðŸŸ¢</span>
                                <button onClick={() => { setForm({mood:currentDayData.journal?.mood, note:currentDayData.journal?.note}); setModal({type:'journal'}); }}><i data-lucide="book-open" class="w-4 h-4 text-gray-400"></i></button>
                            </div>
                        </div>
                        <div className="bg-yellow-50 px-3 py-1 rounded-full border border-yellow-100 flex items-center gap-1 text-yellow-600 font-bold">
                            {data.gold} <i data-lucide="coins" class="w-4 h-4"></i>
                        </div>
                    </div>

                    {/* DATE NAV (Planner only) */}
                    {activeTab === 'planner' && (
                        <div className="flex items-center justify-between p-4 bg-gray-50">
                             <button onClick={() => setSelectedDate(new Date(selectedDate.setDate(selectedDate.getDate() - 1)))}><i data-lucide="chevron-left"></i></button>
                             <span className="font-bold text-gray-700">{selectedDate.toLocaleDateString('tr-TR', { weekday: 'long', day: 'numeric', month: 'long' })}</span>
                             <button onClick={() => setSelectedDate(new Date(selectedDate.setDate(selectedDate.getDate() + 1)))}><i data-lucide="chevron-right"></i></button>
                        </div>
                    )}

                    {/* CONTENT AREA */}
                    <div className="flex-1 overflow-y-auto p-5 bg-gray-50/50 space-y-6 no-scrollbar">
                        
                        {/* --- PLANNER --- */}
                        {activeTab === 'planner' && (
                            <>
                                {/* Rutinler */}
                                <div className="bg-white p-4 rounded-xl shadow-sm border border-gray-100 overflow-x-auto whitespace-nowrap no-scrollbar flex gap-4">
                                    {data.habits.map(h => {
                                        const isDone = (currentDayData.habits||[]).includes(h.id);
                                        return (
                                            <div key={h.id} onClick={() => toggleHabit(h.id)} className="inline-flex flex-col items-center cursor-pointer">
                                                <div className={`w-12 h-12 rounded-full flex items-center justify-center text-xl border-2 transition ${isDone ? 'bg-indigo-50 border-indigo-500':'bg-gray-50 border-gray-200 grayscale'}`}>{h.icon}</div>
                                                <span className={`text-[10px] font-bold mt-1 ${isDone ? 'text-indigo-600':'text-gray-400'}`}>{h.title}</span>
                                            </div>
                                        )
                                    })}
                                </div>

                                {/* GÃ¶revler */}
                                <div className="space-y-3">
                                    {currentDayData.tasks.map(t => (
                                        <div key={t.id} className={`bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex items-start gap-3 ${t.completed ? 'opacity-50':''}`}>
                                            {t.type === 'simple' ? 
                                                <button onClick={() => toggleTask(t.id)} className={`mt-1 w-5 h-5 rounded-full border-2 flex items-center justify-center ${t.completed ? 'bg-green-500 border-green-500 text-white':'border-gray-300'}`}>{t.completed && <i data-lucide="check" class="w-3 h-3"></i>}</button>
                                                : <div className="mt-1 w-5 h-5 bg-indigo-100 rounded-full flex items-center justify-center text-[10px] font-bold text-indigo-600">{t.subItems.filter(Boolean).length}</div>
                                            }
                                            <div className="flex-1">
                                                <div className={`font-bold ${t.completed ? 'line-through text-gray-400':'text-gray-800'}`}>{t.title}</div>
                                                <div className="flex items-center gap-3 text-xs text-gray-400 mt-1">
                                                    <span className="flex items-center gap-1"><i data-lucide="clock" class="w-3 h-3"></i> {t.duration}dk</span>
                                                    {t.startTime && <span className="bg-indigo-50 text-indigo-600 px-1 rounded">{t.startTime}</span>}
                                                </div>
                                                {t.subItems && (
                                                    <div className="flex gap-1 mt-2 flex-wrap">
                                                        {t.subItems.map((done, i) => (
                                                            <button key={i} onClick={() => toggleSubItem(t.id, i)} className={`w-6 h-6 rounded border flex items-center justify-center text-[10px] ${done ? 'bg-green-500 text-white border-green-500':'bg-white text-gray-400'}`}>{done ? 'âœ“':i+1}</button>
                                                        ))}
                                                    </div>
                                                )}
                                            </div>
                                            <button onClick={() => deleteTask(t.id)} className="text-gray-300 hover:text-red-500"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                                        </div>
                                    ))}
                                </div>
                                <button onClick={() => {setForm({}); setModal({type:'selection'});}} className="w-full py-3 border-2 border-dashed border-gray-300 rounded-xl text-gray-400 font-bold hover:text-indigo-600 hover:border-indigo-300 flex items-center justify-center gap-2"><i data-lucide="plus"></i> GÃ¶rev Ekle</button>
                            </>
                        )}

                        {/* --- PROJECTS --- */}
                        {activeTab === 'projects' && (
                            <div className="space-y-6">
                                <div className="flex justify-between items-center"><h2 className="font-bold text-gray-700">BÃ¼yÃ¼k Hedefler</h2><button onClick={() => {setForm({}); setModal({type:'project_form'});}} className="text-xs bg-indigo-50 text-indigo-600 px-3 py-1 rounded font-bold">+ YENÄ°</button></div>
                                {data.projects.map(p => {
                                    const pct = Math.min(100, Math.round(((p.currentUnit||0) / p.totalUnit) * 100));
                                    const isFlipped = flippedCards[p.id];

                                    return (
                                        <div key={p.id} className="relative h-64 perspective-1000 group">
                                            <div className={`w-full h-full relative transition-all duration-700 transform-style-3d ${isFlipped ? 'rotate-y-180' : ''}`}>
                                                {/* Front */}
                                                <div className="absolute inset-0 bg-white p-5 rounded-xl shadow-sm border border-gray-100 backface-hidden flex flex-col justify-between">
                                                    <div>
                                                        <div className="flex justify-between items-start">
                                                            <h3 className="font-bold text-lg">{p.title}</h3>
                                                            <div className="flex gap-2">
                                                                <button onClick={() => {setForm({id:p.id, title:p.title, total:p.totalUnit, unit:p.unit, estTime:p.totalEstTime, current:p.currentUnit, notes:p.notes}); setModal({type:'project_form'});}}><i data-lucide="edit-2" class="w-4 h-4 text-gray-400 hover:text-indigo-600"></i></button>
                                                                <button onClick={() => setFlippedCards({...flippedCards, [p.id]: true})}><i data-lucide="refresh-cw" class="w-4 h-4 text-gray-400 hover:text-indigo-600"></i></button>
                                                            </div>
                                                        </div>
                                                        <span className="text-xs bg-gray-100 px-2 py-1 rounded text-gray-500 mt-2 inline-block">{p.currentUnit}/{p.totalUnit} {p.unit}</span>
                                                    </div>
                                                    <div>
                                                        <div className="flex justify-between text-xs font-bold text-indigo-600 mb-1"><span>Ä°LERLEME</span><span>%{pct}</span></div>
                                                        <div className="h-2 bg-gray-100 rounded-full overflow-hidden"><div className="h-full bg-indigo-600 transition-all duration-500" style={{width: `${pct}%`}}></div></div>
                                                    </div>
                                                </div>
                                                {/* Back */}
                                                <div className="absolute inset-0 bg-gray-800 text-white p-5 rounded-xl shadow-lg rotate-y-180 backface-hidden flex flex-col">
                                                    <div className="flex justify-between border-b border-gray-700 pb-2 mb-2">
                                                        <span className="text-xs font-bold tracking-widest text-gray-400">KASA</span>
                                                        <button onClick={() => setFlippedCards({...flippedCards, [p.id]: false})}><i data-lucide="refresh-cw" class="w-4 h-4"></i></button>
                                                    </div>
                                                    <textarea className="flex-1 bg-gray-700 rounded p-2 text-sm text-gray-200 resize-none mb-2" placeholder="Notlar..." value={p.notes||''} onChange={(e) => updateProjectNotes(p.id, e.target.value)}></textarea>
                                                    <button onClick={() => {if(confirm('Sil?')) {const n=data.projects.filter(x=>x.id!==p.id); saveToFirebase({...data, projects:n});}}} className="text-xs text-red-400 text-right hover:text-red-300">Projeyi Sil</button>
                                                </div>
                                            </div>
                                        </div>
                                    )
                                })}
                            </div>
                        )}

                        {/* --- HABITS EDIT --- */}
                        {activeTab === 'habits' && (
                            <div className="space-y-4">
                                <h2 className="font-bold text-gray-700">Rutin DÃ¼zenleyici</h2>
                                {data.habits.map(h => (
                                    <div key={h.id} className="flex justify-between items-center p-3 bg-white rounded-xl border">
                                        <div className="flex items-center gap-3"><span className="text-2xl">{h.icon}</span><span className="font-bold">{h.title}</span></div>
                                        <button onClick={() => deleteHabit(h.id)} className="text-red-400"><i data-lucide="trash-2"></i></button>
                                    </div>
                                ))}
                                <div className="pt-4 border-t mt-4">
                                    <div className="flex gap-2">
                                        <input className="w-16 p-2 border rounded text-center" placeholder="ðŸ§˜" value={form.icon||''} onChange={e=>setForm({...form, icon:e.target.value})} />
                                        <input className="flex-1 p-2 border rounded" placeholder="Rutin AdÄ±" value={form.title||''} onChange={e=>setForm({...form, title:e.target.value})} />
                                    </div>
                                    <button onClick={addHabit} className="w-full bg-indigo-600 text-white py-2 rounded mt-2 font-bold">Ekle</button>
                                </div>
                            </div>
                        )}

                        {/* --- STORE --- */}
                        {activeTab === 'store' && (
                            <div className="space-y-6">
                                <div className="bg-yellow-400 p-6 rounded-2xl text-white shadow-lg flex items-center justify-between">
                                    <div><div className="opacity-80 text-sm font-bold">BAKÄ°YE</div><div className="text-4xl font-bold">{data.gold}</div></div>
                                    <i data-lucide="coins" class="w-12 h-12 opacity-50"></i>
                                </div>
                                <div className="grid grid-cols-2 gap-3">
                                    {data.rewards.map(r => (
                                        <div key={r.id} onClick={() => buyReward(r)} className="bg-white p-4 rounded-xl border hover:shadow-md cursor-pointer relative group">
                                            <button onClick={(e) => {e.stopPropagation(); deleteReward(r.id);}} className="absolute top-2 right-2 opacity-0 group-hover:opacity-100 text-red-400"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                                            <div className="text-2xl mb-2">{r.icon}</div>
                                            <div className="font-bold text-sm leading-tight">{r.title}</div>
                                            <div className="text-xs font-bold text-yellow-600 mt-1">{r.cost} AltÄ±n</div>
                                        </div>
                                    ))}
                                    <button onClick={() => {setForm({}); setModal({type:'reward_new'})}} className="border-2 border-dashed rounded-xl flex flex-col items-center justify-center text-gray-400 min-h-[100px] hover:border-indigo-400 hover:text-indigo-600"><i data-lucide="plus"></i><span className="text-xs font-bold mt-1">Ã–dÃ¼l Ekle</span></button>
                                </div>
                            </div>
                        )}

                        {/* --- CALENDAR & TIMELINE --- */}
                        {activeTab === 'calendar' && (
                            <div className="space-y-6">
                                <div className="bg-white p-4 rounded-xl shadow-sm border">
                                    <h3 className="text-center font-bold mb-4">{selectedDate.toLocaleDateString('tr-TR', { month: 'long', year: 'numeric' })}</h3>
                                    <div className="grid grid-cols-7 gap-2">
                                        {Array.from({ length: new Date(selectedDate.getFullYear(), selectedDate.getMonth() + 1, 0).getDate() }, (_, i) => {
                                            const d = i + 1;
                                            const dDate = new Date(selectedDate.getFullYear(), selectedDate.getMonth(), d);
                                            const k = getDateKey(dDate);
                                            const hasData = data.history[k];
                                            const isSelected = k === dateKey;
                                            let bg = 'bg-gray-50 text-gray-400';
                                            if (hasData) {
                                                // Basit skorlama: GÃ¶rev varsa turkuaz
                                                if (hasData.tasks && hasData.tasks.length > 0) bg = 'bg-green-100 text-green-600';
                                            }
                                            if (isSelected) bg = 'bg-indigo-600 text-white';

                                            return <div key={d} onClick={() => setSelectedDate(dDate)} className={`aspect-square rounded flex items-center justify-center text-xs font-bold cursor-pointer ${bg}`}>{d}</div>
                                        })}
                                    </div>
                                </div>
                                
                                <div>
                                    <h3 className="font-bold text-gray-500 mb-2">BU GÃœNÃœM</h3>
                                    <div className="bg-white rounded-xl shadow-sm border p-4 space-y-2">
                                        {Array.from({length: 18}, (_, i) => i + 6).map(h => {
                                            const tasksInHour = currentDayData.tasks.filter(t => t.startTime && parseInt(t.startTime.split(':')[0]) === h);
                                            return (
                                                <div key={h} className="flex gap-4 h-12 border-b border-gray-50 last:border-0">
                                                    <div className="w-10 text-xs text-gray-400 pt-2 text-right">{h.toString().padStart(2,'0')}:00</div>
                                                    <div className="flex-1 relative">
                                                        {tasksInHour.map(t => (
                                                            <div key={t.id} className="absolute top-1 left-0 right-0 bottom-1 bg-indigo-50 border-l-4 border-indigo-500 rounded px-2 flex items-center text-xs font-bold text-indigo-700">
                                                                {t.title} ({t.duration}dk)
                                                            </div>
                                                        ))}
                                                    </div>
                                                </div>
                                            )
                                        })}
                                    </div>
                                </div>
                            </div>
                        )}
                        <div className="h-20"></div>
                    </div>

                    {/* BOTTOM NAV */}
                    <div className="bg-white border-t flex justify-around p-2 pb-6">
                        {['calendar', 'projects', 'planner', 'habits', 'store'].map(t => (
                            <button key={t} onClick={() => setActiveTab(t)} className={`p-2 flex flex-col items-center ${activeTab===t ? 'text-indigo-600':'text-gray-400'}`}>
                                {t === 'planner' ? <div className="w-10 h-10 bg-indigo-600 rounded-full flex items-center justify-center text-white -mt-6 shadow-lg"><i data-lucide="plus"></i></div> : 
                                <><i data-lucide={t==='habits'?'list':t} class="w-5 h-5"></i><span className="text-[9px] font-bold mt-1 uppercase">{t}</span></>}
                            </button>
                        ))}
                    </div>

                    {/* MODAL */}
                    {modal.open && (
                        <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
                            <div className="bg-white w-full max-w-sm rounded-2xl p-6 shadow-2xl animate-in fade-in slide-in-from-bottom-10">
                                <div className="flex justify-between mb-4">
                                    <h3 className="font-bold text-lg uppercase">{modal.type.replace('_', ' ')}</h3>
                                    <button onClick={() => setModal({open:false})}><i data-lucide="x"></i></button>
                                </div>

                                {modal.type === 'selection' && (
                                    <div className="space-y-3">
                                        <button onClick={() => {setForm({}); setModal({type:'simple'});}} className="w-full p-4 bg-indigo-50 text-indigo-600 rounded-xl font-bold text-left">âž• Tek Seferlik GÃ¶rev</button>
                                        <div className="text-xs font-bold text-gray-400 mt-2">HEDEFLERDEN Ã‡EK</div>
                                        <div className="max-h-40 overflow-y-auto space-y-2">
                                            {data.projects.map(p => (
                                                <button key={p.id} onClick={() => {setForm({amount:''}); setModal({type:'import', data:p});}} className="w-full p-3 border rounded-xl text-left text-sm font-bold hover:bg-gray-50">{p.title}</button>
                                            ))}
                                        </div>
                                    </div>
                                )}

                                {(modal.type === 'simple' || modal.type === 'import') && (
                                    <div className="space-y-3">
                                        {modal.type === 'import' && <h4 className="text-indigo-600 font-bold text-center mb-2">{modal.data.title}</h4>}
                                        {modal.type === 'simple' && <input className="w-full p-3 bg-gray-50 rounded-xl" placeholder="GÃ¶rev AdÄ±" autoFocus onChange={e=>setForm({...form, title:e.target.value})} />}
                                        {modal.type === 'import' && <div className="flex items-baseline justify-center gap-2"><input type="number" className="w-20 text-center text-3xl font-bold border-b-2 border-indigo-600 outline-none" placeholder="0" autoFocus onChange={e=>setForm({...form, amount:e.target.value})} /><span className="font-bold text-gray-400">{modal.data.unit}</span></div>}
                                        <div className="flex gap-2">
                                            <input type="number" className="flex-1 p-3 bg-gray-50 rounded-xl" placeholder="SÃ¼re (dk)" value={form.time||''} onChange={e=>setForm({...form, time:e.target.value})} />
                                            <input className="flex-1 p-3 bg-gray-50 rounded-xl" placeholder="Saat (14:00)" value={form.startTime||''} onChange={e=>setForm({...form, startTime:e.target.value})} />
                                        </div>
                                        <button onClick={addTask} className="w-full bg-indigo-600 text-white py-3 rounded-xl font-bold mt-2">EKLE</button>
                                    </div>
                                )}

                                {modal.type === 'project_form' && (
                                    <div className="space-y-3">
                                        <input className="w-full p-3 bg-gray-50 rounded-xl" placeholder="Proje AdÄ±" value={form.title||''} onChange={e=>setForm({...form, title:e.target.value})} />
                                        <div className="flex gap-2"><input type="number" className="flex-1 p-3 bg-gray-50 rounded-xl" placeholder="Toplam" value={form.total||''} onChange={e=>setForm({...form, total:e.target.value})} /><input className="flex-1 p-3 bg-gray-50 rounded-xl" placeholder="Birim" value={form.unit||''} onChange={e=>setForm({...form, unit:e.target.value})} /></div>
                                        <div className="flex gap-2"><input type="number" className="flex-1 p-3 bg-gray-50 rounded-xl" placeholder="BaÅŸlangÄ±Ã§" value={form.current||''} onChange={e=>setForm({...form, current:e.target.value})} /><input type="number" className="flex-1 p-3 bg-gray-50 rounded-xl" placeholder="Tahmini Saat" value={form.estTime||''} onChange={e=>setForm({...form, estTime:e.target.value})} /></div>
                                        <button onClick={saveProject} className="w-full bg-indigo-600 text-white py-3 rounded-xl font-bold mt-2">KAYDET</button>
                                    </div>
                                )}

                                {(modal.type === 'reward_new') && (
                                    <div className="space-y-3">
                                        <div className="flex gap-2"><input type="number" className="flex-1 p-3 bg-gray-50 rounded-xl" placeholder="Bedel" value={form.cost||''} onChange={e=>setForm({...form, cost:e.target.value})} /><input className="w-16 p-3 bg-gray-50 rounded-xl text-center" placeholder="ðŸŽ" value={form.icon||''} onChange={e=>setForm({...form, icon:e.target.value})} /></div>
                                        <input className="w-full p-3 bg-gray-50 rounded-xl" placeholder="Ã–dÃ¼l AdÄ±" value={form.title||''} onChange={e=>setForm({...form, title:e.target.value})} />
                                        <button onClick={addReward} className="w-full bg-indigo-600 text-white py-3 rounded-xl font-bold mt-2">EKLE</button>
                                    </div>
                                )}

                                {modal.type === 'journal' && (
                                    <div className="space-y-3">
                                        <div className="flex justify-around text-2xl bg-gray-50 p-3 rounded-xl">
                                            {['ðŸ˜«','ðŸ˜','ðŸ™‚','ðŸ˜ƒ','ðŸ¤©'].map(m => <button key={m} onClick={()=>setForm({...form, mood:m})} className={`p-2 rounded hover:bg-white ${form.mood===m?'bg-white shadow':''}`}>{m}</button>)}
                                        </div>
                                        <textarea className="w-full p-3 bg-gray-50 rounded-xl h-32" placeholder="BugÃ¼n nasÄ±l geÃ§ti?" value={form.note||''} onChange={e=>setForm({...form, note:e.target.value})}></textarea>
                                        <button onClick={saveJournal} className="w-full bg-indigo-600 text-white py-3 rounded-xl font-bold">KAYDET</button>
                                    </div>
                                )}
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
